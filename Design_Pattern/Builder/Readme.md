# 设计模式——生成器模式

## 引言

在上一章的时候，写了关于工厂模式的三个种类，这一篇也是我第二天学完马上写的，当是一种复习理解，用自己的话来告诉大家什么是生成器模式，其实上一篇我感觉自己写得并不是很好，毕竟在学的时候没涉及到太多开发方面的知识，不能更具体明了的讲明白，只能用我自己的理解去告诉大家。

先回顾一下，**工厂方法模式**就是通过工厂去控制具体产品的生产，客户不需要知道具体生产过程，只需要知道自己想要什么就可以了，一个水果工厂，客户需要香蕉，就调用生产香蕉的方法，其他也如此。而**抽象工厂模式**，又是在一个水果工厂上加一个大的生物工厂，可以生产水果和动物，水果工厂和动物工厂各司其职，但生产出来的产品是一系列的，水果工厂只生产水果，动物工厂只生产动物。其实学完工厂模式后有一种感觉，看啥都像个工厂，这次就来学习一个略有不同的设计模式：**生成器模式**。（其实听这名字也像个工厂，毕竟工厂从宏观来说也算个生成器）

## 生成器模式

### 一、别称

##### **建造者模式、Builder**

### 二、意图

生产者模式是一种**创造型模式**，他允许分步骤去创建复杂的对象。该模式是允许你用**相同的创建代码**创建出**不同类型**的对象。

### 三、问题

假设，我有一个房子，我最开始的版本就是一个普通的房子。可有一天，我女朋友跟我讲，“亲爱的，我想要一个泳池”，我一听，框框去给她在旁边的地皮上挖了一个泳池。然后，她还是不满足，她又说“亲爱的，我想要一个车库”，我一听，又马不停蹄地在房子旁边加了个车库。后来，她觉得缺了点绿化，又和我说，我说“打住，我知道了”，然后买了很多树回来插在我家旁边。人的欲望如同高山滚石。。。我总不能在最开始的时候就给我的女朋友建好这么多的东西，但如果后面要我加，也挺麻烦的，换成代码视角，我有一个**房子（house）**的基类，在我最初创建这个基类时里面就有了**创建地基（createbasic）**, **创建墙壁（createbackgroud）**，**创建房顶（createTop）**等。。。如果我在后面需要像这样扩展，我该怎么办呢？

### 四、解决方案

其实这种情况有个最简单的方法，就是扩展我的房子基类，在这个基类的基础上不断地增加带着各种参数的子类，也就是在我女朋友没要求我之前就给她建好一个带泳池的房子，或者是一个带车库的房子，甚至是都带有的房子，然后她说要哪个我们就直接搬家过去，这种土豪行为我们不提倡，写代码的时候也不提倡！！

有另一种方法，就是给我的房子基类上写一个超级构造函数，什么叫超级，就是在构造的时候我要什么里面都有，我在建这个房子的时候就和我女朋友说，“你，马上告诉我你需要这个房子有什么，我现在就建好，建完之后我就不扩张了”，这无疑是不可能的，谁知道她到底想要什么，万一我建的房子里面的都有了，她哪天给我来一句，“我想要个足球场”，那我也无能为力了。

这时候，我们的**生成器模式（Build Pattern）**，就出现了，他建议是将产品的构造函数抽出来，让**生成器(Builder)**去帮他构造，而生成器是一个独立的对象。到这里，是不是感觉和工厂越看越像了，别着急，工厂注重的是**生产的结果**，我需要的是产品，而生成器**注重过程**，我该以什么步骤，什么方式去构建这个产品，就是生成器要做的事情。就是说，我的生成器里包含了对我房子建设的方案，包括：**创建地基（createbasic）**, **创建墙壁（createbackgroud）**，**创建房顶（createTop）**等，而这些方法里也会有不同的构建方式，可能我的地基，墙壁，房顶都是用茅草盖的，那他该出来的就是个茅草屋，也可能是黄金钻石，那他出来的可能就是一个金碧辉煌的房子，一切都由具体的生成器（ConcreteBuilder）去做。那我刁钻点，我不想要房顶，我想感受大自然，可以啊！那就实现的时候不调用建房顶这个就行了嘛，可是，谁来用生成器呢，其实客户端自己也能用，不过带着能偷懒就偷懒，我们再引进来一个新的人物：**主管（Director）**。

#### 主管（Director）

主管的作用其实就是在我只需要一个基础的对象，或者是一些常用对象的构建时，我可以在主管内预设好他的方法，比如我只要主管指挥生成器建一个地基，或者我要建好一个完整的房子，这些方案，我可以先给主管预设好，他就可以帮我很快速的完成我需要的东西，不过，万一我又像上面这样，只要墙壁和地基，不用房顶，我就需要自己去调用具体步骤了，毕竟没有哪个人建房子的方案里会加一个不要房顶。

### 五、应用场景

1. 可以避免重叠构造函数的出现，就是一个对象的参数非常多，在构造函数中就需要重载枚举各种各样的构造时，就可以使用生成器模式。
2. 当你希望使用代码创建不同形式的产品（例如石头或木头房屋）时，也可以使用生成器模式。强调一点，这和工厂模式不同，工厂模式下生成的是属于一个具体的产品或者一个系列的产品，而生成者是对这个产品的生产步骤和生产方式分成不同的实现方法，最后得出来的产品也会因为他的生产步骤和生产方式不同而不同。

### 优缺点

#### 优点

- *单一职责原则*。 你可以将复杂构造代码从产品的业务逻辑中分离出来。
- 生成不同形式的产品时， 你可以复用相同的制造代码。
- 你可以分步创建对象， 暂缓创建步骤或递归运行创建步骤。

#### 缺点

- 由于该模式需要新增多个类， 因此代码整体复杂程度会有所增加。

